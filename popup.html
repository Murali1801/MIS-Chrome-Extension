<!DOCTYPE html>
<html>
<head>
    <title>Attendance Enhancer</title>
    <style>
        /* --- Base & Theme Variables --- */
        :root {
            --bg-gradient: linear-gradient(135deg, #f5f3ff 0%, #eef2ff 100%);
            --text-primary: #4c1d95; --text-secondary: #5b21b6;
            --glass-bg: rgba(255, 255, 255, 0.6); --glass-border: rgba(255, 255, 255, 0.8);
            --button-primary-bg: #7c3aed; --button-primary-hover: #6d28d9;
            --button-secondary-bg: rgba(124, 58, 237, 0.1); --button-secondary-hover: rgba(124, 58, 237, 0.2);
            --button-danger-bg: rgba(220, 38, 38, 0.1); --button-danger-hover: rgba(220, 38, 38, 0.2);
            --button-danger-text: #b91c1c; --status-color: #166534;
            --list-bg: rgba(255, 255, 255, 0.5); --toggle-bg: #a78bfa;
        }
        body[data-theme='dark'] {
            --bg-gradient: linear-gradient(135deg, #2b0b3a 0%, #1e1b4b 100%);
            --text-primary: #e9d5ff; --text-secondary: #c084fc;
            --glass-bg: rgba(255, 255, 255, 0.05); --glass-border: rgba(255, 255, 255, 0.15);
            --button-primary-bg: #8b5cf6; --button-primary-hover: #7c3aed;
            --button-secondary-bg: rgba(255, 255, 255, 0.1); --button-secondary-hover: rgba(255, 255, 255, 0.15);
            --button-danger-bg: rgba(239, 68, 68, 0.3); --button-danger-hover: rgba(239, 68, 68, 0.4);
            --button-danger-text: #fecaca; --status-color: #d1fae5;
            --list-bg: rgba(0, 0, 0, 0.2); --toggle-bg: #7c3aed;
        }
        /* --- General Styles --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; width: 380px; padding: 15px; background: var(--bg-gradient); background-attachment: fixed; }
        .glass-container { background: var(--glass-bg); border-radius: 16px; box-shadow: 0 4px 30px rgba(0,0,0,0.1); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border: 1px solid var(--glass-border); padding: 20px; margin-bottom: 15px; }
        h3 { font-weight: 500; color: var(--text-primary); }
        label { font-weight: 500; font-size: 14px; color: var(--text-secondary); display: block; margin-top: 15px; }
        input { width: 100%; margin-top: 5px; padding: 10px; border-radius: 8px; background: var(--button-secondary-bg); border: 1px solid var(--glass-border); color: var(--text-primary); font-size: 14px; }
        input:focus { outline: none; border-color: var(--button-primary-bg); }
        input[type="date"]::-webkit-calendar-picker-indicator { filter: var(--text-primary) == '#e9d5ff' ? invert(1) : invert(0.2); cursor: pointer; }
        button { width: 100%; margin-top: 15px; padding: 10px; font-weight: bold; cursor: pointer; color: white; border: none; border-radius: 8px; transition: background-color 0.2s ease; }
        .button-primary { background-color: var(--button-primary-bg); }
        .button-primary:hover { background-color: var(--button-primary-hover); }
        .button-group { display: flex; gap: 10px; }
        .button-secondary { background-color: var(--button-secondary-bg); color: var(--text-primary); border: 1px solid var(--glass-border); }
        .button-secondary:hover { background-color: var(--button-secondary-hover); }
        .button-danger { background-color: var(--button-danger-bg); color: var(--button-danger-text); font-weight: bold; }
        .button-danger:hover { background-color: var(--button-danger-hover); }
        #status { text-align: center; margin-top: 15px; font-weight: 500; color: var(--status-color); height: 16px; }
        
        /* --- Header & Toggles --- */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .theme-toggle-btn { background: none; border: none; cursor: pointer; padding: 5px; width: auto; margin: 0; }
        .theme-toggle-btn img { width: 20px; height: 20px; }
        .feature-toggle { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; }
        .feature-toggle label { margin: 0; color: var(--text-primary); }
        .switch { position: relative; display: inline-block; width: 40px; height: 20px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 20px; }
        .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--toggle-bg); }
        input:checked + .slider:before { transform: translateX(20px); }

        /* --- Student List --- */
        #student_list { max-height: 140px; overflow-y: auto; border: 1px solid var(--glass-border); border-radius: 8px; background-color: var(--list-bg); margin-top: 10px; padding: 8px 0; }
        .student-item { display: flex; align-items: center; padding: 8px 10px; border-bottom: 1px solid var(--glass-border); color: var(--text-primary); }
        .student-item:last-child { border-bottom: none; }
        .student-item .student-name { flex-grow: 1; margin: 0 8px; }
        .student-item .edit-btn { margin-left: auto; width: auto; font-size: 10px; padding: 4px 8px; background-color: var(--button-secondary-bg); color: var(--text-primary); border: 1px solid var(--glass-border); }
        .list-controls { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; }
        .list-controls label { margin: 0; display: flex; align-items: center; gap: 5px; font-size: 12px; }
    </style>
</head>
<body data-theme="light">
    <div class="glass-container">
        <div class="header">
            <h3>Attendance Enhancer</h3>
            <button id="theme_toggle_btn" class="theme-toggle-btn">
                <img id="theme_icon" src="moon-icon.svg" alt="Toggle Theme">
            </button>
        </div>
        <div>
            <label for="start_date">Calculate attendance from:</label>
            <input type="date" id="start_date">
        </div>
        <button id="save_date_btn" class="button-primary">Save Date</button>
        <div id="status"></div>
    </div>

    <div class="glass-container">
        <h3>Credential Manager</h3>
        <input type="text" id="search_input" placeholder="Search users...">
        <div id="student_list"></div>
        <div class="list-controls">
            <label><input type="checkbox" id="select_all_checkbox">Select All</label>
            <button id="delete_selected_btn" class="button-danger" style="width: auto; padding: 5px 10px;">Delete Selected</button>
        </div>
        <div class="button-group" style="margin-top: 20px;">
            <button id="import_btn" class="button-secondary">Import JSON</button>
            <button id="export_btn" class="button-secondary">Export JSON</button>
        </div>
        <button id="delete_all_btn" class="button-danger">Delete All Credentials</button>
        <input type="file" id="import_file" accept=".json" style="display: none;">
    </div>

    <div class="glass-container">
        <h3>Settings</h3>
        <div class="feature-toggle">
            <label for="autoLoginToggle">Auto-Login Search</label>
            <label class="switch">
                <input type="checkbox" id="autoLoginToggle">
                <span class="slider"></span>
            </label>
        </div>
        <div class="feature-toggle">
            <label for="attendanceCalcToggle">Attendance Calculator</label>
            <label class="switch">
                <input type="checkbox" id="attendanceCalcToggle">
                <span class="slider"></span>
            </label>
        </div>
        <div class="feature-toggle">
            <label for="saveCredentialsToggle">Save Credentials on Login</label>
            <label class="switch">
                <input type="checkbox" id="saveCredentialsToggle">
                <span class="slider"></span>
            </label>
        </div>
    </div>

    <script src="popup.js"></script>
</body>
</html>